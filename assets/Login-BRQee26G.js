import{_ as z,r as b,R as k,B as P,c as H,o as R,S as T,T as D,a as C,d as u,w as d,V as F,e as U,u as q,f as J,y as W,g as v,k as E,m as S,b as s,j as w,n as K,K as j,L as Q,M as X,x as Y,N as M,z as _,v as V,t as ee}from"./index-CZ_U_2su.js";const A={client_id:"876709571626-7mo1vufj60io8ddaa8lb99e2bpi2n3ib.apps.googleusercontent.com"};class te{constructor(){this.isInitialized=!1,this.initPromise=null}async init(){if(!this.isInitialized){if(this.initPromise)return this.initPromise;this.initPromise=new Promise((o,n)=>{if(window.google)this.setupGoogleAuth(),o();else{const a=document.createElement("script");a.src="https://accounts.google.com/gsi/client",a.async=!0,a.defer=!0,a.onload=()=>{this.setupGoogleAuth(),o()},a.onerror=()=>n(new Error("Failed to load Google Identity Services")),document.head.appendChild(a)}}),await this.initPromise,this.isInitialized=!0}}setupGoogleAuth(){window.google&&window.google.accounts.id.initialize({client_id:A.client_id,callback:this.handleCredentialResponse.bind(this)})}handleCredentialResponse(o){try{const n=this.parseJwt(o.credential);this.lastCredential=o.credential,this.lastUserInfo=n;const a=new CustomEvent("googleAuthSuccess",{detail:{credential:o.credential,userInfo:n}});window.dispatchEvent(a)}catch(n){console.error("Error handling Google credential:",n);const a=new CustomEvent("googleAuthError",{detail:{error:n.message}});window.dispatchEvent(a)}}parseJwt(o){try{const a=o.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(a).split("").map(function(c){return"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)}catch{throw new Error("Invalid token format")}}async renderSignInButton(o,n={}){return await this.init(),new Promise((a,r)=>{if(window.google){const c={type:"standard",theme:"outline",size:"large",text:"signup_with",shape:"rectangular",width:270,logo_alignment:"center"};try{const m=document.getElementById(o);if(!m){r(new Error(`Element with id "${o}" not found`));return}window.google.accounts.id.renderButton(m,{...c,...n});const i=new MutationObserver((l,p)=>{const y=m.querySelector("iframe")||m.querySelector('div[role="button"]');y&&(p.disconnect(),setTimeout(()=>a(y),100))});i.observe(m,{childList:!0,subtree:!0}),setTimeout(()=>{i.disconnect(),a(null)},3e3)}catch(m){r(m)}}else r(new Error("Google Identity Services not loaded"))})}async signInWithPopup(){return await this.init(),new Promise((o,n)=>{if(!window.google){n(new Error("Google Identity Services not loaded"));return}const a=r=>{try{if(r&&r.credential){const c=this.parseJwt(r.credential);this.lastCredential=r.credential,this.lastUserInfo=c,o({credential:r.credential,userInfo:c})}else n(new Error("Invalid response from Google"))}catch(c){n(c)}};window.google.accounts.id.initialize({client_id:A.client_id,callback:a});try{window.google.accounts.id.prompt(r=>{r.isNotDisplayed()?(console.error("Google Sign-In prompt not displayed:",r.getNotDisplayedReason()),n(new Error(`Google Sign-In was not displayed: ${r.getNotDisplayedReason()}`))):r.isSkippedMoment()?(console.error("Google Sign-In prompt skipped:",r.getSkippedReason()),n(new Error(`Google Sign-In was skipped: ${r.getSkippedReason()}`))):r.isDismissedMoment()&&(console.error("Google Sign-In prompt dismissed:",r.getDismissedReason()),n(new Error(`Google Sign-In was dismissed: ${r.getDismissedReason()}`)))})}catch(r){console.error("Error during Google prompt:",r),n(r)}})}getLastUserInfo(){return this.lastUserInfo}getLastCredential(){return this.lastCredential}convertToAppUser(o){return{id:`google_${o.sub}`,email:o.email,firstName:o.given_name||"",lastName:o.family_name||"",fullName:o.name||"",avatar:o.picture||"",isEmailVerified:o.email_verified||!1,provider:"google",googleId:o.sub,preferences:{notifications:!0,theme:"light"},createdAt:new Date().toISOString(),lastLoginAt:new Date().toISOString()}}processCredential(o){try{const n=this.parseJwt(o);return this.lastCredential=o,this.lastUserInfo=n,{credential:o,userInfo:n}}catch(n){throw new Error(`Failed to process credential: ${n.message}`)}}signOut(){this.lastCredential=null,this.lastUserInfo=null,window.google&&window.google.accounts.id.disableAutoSelect()}}const I=new te,se={class:"auth-page"},oe={class:"form-group"},re={key:0,class:"custom-svg-icon",style:{display:"flex","align-items":"center",height:"100%"}},ne={key:1,class:"custom-svg-icon",style:{display:"flex","align-items":"center",height:"100%"}},ie={class:"form-group"},ae={key:0,class:"custom-svg-icon",style:{display:"flex","align-items":"center",height:"100%"}},le={key:1,class:"custom-svg-icon",style:{display:"flex","align-items":"center",height:"100%"}},de={class:"forgot-password-container mb-4"},ue={class:"auth-switch"},ce={class:"switch-text"},ge={__name:"Login",setup(Z){const o=q(),n=J(),a=b(null),r=b(!1),c=b(!1),m=b(!1),i=k({email:"",password:""}),l=k({email:[],password:[]});P(()=>i.email,t=>{l.email=[],t?/.+@.+\..+/.test(t)||l.email.push("Please enter a valid email address (e.g., user@example.com)"):l.email.push("Please enter your email address")}),P(()=>i.password,t=>{l.password=[],t?t.length<6&&l.password.push("Password must be at least 6 characters long"):l.password.push("Please enter your password")});const p=k({show:!1,message:"",color:"success"}),y=H(()=>i.email&&i.password&&/.+@.+\..+/.test(i.email)&&i.password.length>=6),O=()=>{const t=x(i.email),e=L(i.password);return t&&e},x=t=>{if(l.email=[],t){if(!/.+@.+\..+/.test(t))return l.email.push("Please enter a valid email address (e.g., user@example.com)"),!1}else return l.email.push("Please enter your email address"),!1;return!0},L=t=>{if(l.password=[],t){if(t.length<6)return l.password.push("Password must be at least 6 characters long"),!1}else return l.password.push("Please enter your password"),!1;return!0},N=async()=>{if(O()){c.value=!0;try{await o.dispatch("login",{email:i.email,password:i.password}),f("Login successful! Welcome back.","success"),setTimeout(()=>{n.push({name:"Profile"})},1500)}catch{f("Login failed. Please check your credentials.","error")}finally{c.value=!1}}},f=(t,e)=>{p.message=t,p.color=e,p.show=!0},G=async t=>{c.value=!0;try{const{userInfo:e}=t.detail,h=I.convertToAppUser(e);await o.dispatch("googleSignup",h),f("Login successful with Google! Welcome back.","success"),setTimeout(()=>{n.push({name:"Profile"})},1500)}catch(e){console.error("Google login error:",e),f("Google login failed. Please try again.","error")}finally{c.value=!1}},B=t=>{console.error("Google auth error:",t.detail),f("Google authentication failed. Please try again.","error")},$=()=>{const t=document.getElementById("google-signin-button-login");if(!t)return null;const e=new MutationObserver(h=>{const g=t.querySelector('iframe, div[role="button"]');g&&(g.style.margin="0 auto",m.value=!0)});return e.observe(t,{childList:!0,subtree:!0}),window.googleLoginButtonObserver=e,e};return R(async()=>{try{await I.init(),window.addEventListener("googleAuthSuccess",G),window.addEventListener("googleAuthError",B);const t=$();await T();const e=document.getElementById("google-signin-button-login");if(e)try{await I.renderSignInButton("google-signin-button-login",{type:"standard",theme:"outline",size:"large",text:"signin_with",shape:"rectangular",width:270,logo_alignment:"center"});const h=e.querySelector('iframe, div[role="button"]');h&&(h.style.margin="0 auto",m.value=!0)}catch(h){console.error("Error rendering Google button:",h),m.value=!1}}catch(t){console.error("Failed to initialize Google Auth:",t)}}),D(()=>{window.removeEventListener("googleAuthSuccess",G),window.removeEventListener("googleAuthError",B),window.googleLoginButtonObserver&&(window.googleLoginButtonObserver.disconnect(),window.googleLoginButtonObserver=null)}),(t,e)=>{const h=W("router-link");return v(),C("div",se,[u(F,{class:"auth-container"},{default:d(()=>[u(E,{justify:"center",class:"header-row"},{default:d(()=>[u(S,{cols:"12",md:"10",lg:"8",class:"text-center"},{default:d(()=>e[7]||(e[7]=[s("div",{class:"auth-header"},[s("div",{class:"hero-content text-center"},[s("h1",{class:"header-title"},[w(" it's easy to customize your profile."),s("br"),w(" join iLink to be smart "),s("span",{class:"highlight"},"NOW!")])])],-1)])),_:1,__:[7]})]),_:1}),u(E,{justify:"center",align:"center",class:"form-row"},{default:d(()=>[u(S,{cols:"12",sm:"8",md:"6",lg:"4",xl:"3"},{default:d(()=>[u(K,{class:"auth-card",elevation:"0"},{default:d(()=>[u(j,{class:"text-center"},{default:d(()=>e[8]||(e[8]=[s("h2",{class:"card-title"},"Log In",-1)])),_:1,__:[8]}),u(Q,{class:"auth-content"},{default:d(()=>[u(X,{onSubmit:Y(N,["prevent"]),ref_key:"loginForm",ref:a},{default:d(()=>[s("div",oe,[u(M,{modelValue:i.email,"onUpdate:modelValue":e[0]||(e[0]=g=>i.email=g),type:"email",placeholder:"E-mail",variant:"outlined",class:"auth-input","error-messages":l.email,error:l.email.length>0,"persistent-hint":"",hint:!i.email&&!l.email.length?"Enter your email address":"",onBlur:e[1]||(e[1]=g=>x(i.email)),required:""},{"prepend-inner":d(()=>[t.$store.state.theme==="light"?(v(),C("span",re,e[9]||(e[9]=[s("svg",{width:"19",height:"20",viewBox:"0 0 19 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M17.6 19.7299C17.3 19.7299 17.01 19.5799 16.86 19.2999C15.37 16.7199 12.59 15.1199 9.60999 15.1199C6.62999 15.1199 3.84999 16.7199 2.35999 19.2999C2.11999 19.7099 1.59999 19.8499 1.18999 19.6099C0.779987 19.3699 0.639982 18.8499 0.879982 18.4399C2.67998 15.3299 6.02999 13.3999 9.61999 13.3999C13.21 13.3999 16.56 15.3299 18.36 18.4399C18.6 18.8499 18.46 19.3799 18.05 19.6099C17.91 19.6899 17.77 19.7299 17.62 19.7299H17.6Z",fill:"black"}),s("path",{d:"M13.05 19.73C12.75 19.73 12.46 19.58 12.31 19.3C11.75 18.34 10.72 17.74 9.61003 17.74C8.50003 17.74 7.47004 18.34 6.91004 19.3C6.67004 19.71 6.15003 19.85 5.74003 19.61C5.33003 19.37 5.19003 18.85 5.43003 18.44C6.29003 16.95 7.90004 16.02 9.62004 16.02C11.34 16.02 12.95 16.95 13.81 18.44C14.05 18.85 13.91 19.38 13.5 19.61C13.36 19.69 13.22 19.73 13.07 19.73H13.05Z",fill:"black"}),s("path",{d:"M9.60998 12.53C6.22998 12.53 3.47998 9.78002 3.47998 6.40002C3.47998 3.02002 6.22998 0.27002 9.60998 0.27002C12.99 0.27002 15.74 3.02002 15.74 6.40002C15.74 9.78002 12.99 12.53 9.60998 12.53ZM9.60998 1.98004C7.17998 1.98004 5.19997 3.96005 5.19997 6.39005C5.19997 8.82005 7.17998 10.8 9.60998 10.8C12.04 10.8 14.02 8.82005 14.02 6.39005C14.02 3.96005 12.04 1.98004 9.60998 1.98004Z",fill:"black"})],-1)]))):_("",!0),t.$store.state.theme==="dark"?(v(),C("span",ne,e[10]||(e[10]=[s("svg",{width:"19",height:"20",viewBox:"0 0 19 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M17.75 19.7299C17.45 19.7299 17.16 19.5799 17.01 19.2999C15.52 16.7199 12.74 15.1199 9.75999 15.1199C6.77999 15.1199 3.99999 16.7199 2.50999 19.2999C2.26999 19.7099 1.75001 19.8499 1.34001 19.6099C0.930006 19.3699 0.790008 18.8499 1.03001 18.4399C2.83001 15.3299 6.18 13.3999 9.77 13.3999C13.36 13.3999 16.71 15.3299 18.51 18.4399C18.75 18.8499 18.61 19.3799 18.2 19.6099C18.06 19.6899 17.92 19.7299 17.77 19.7299H17.75Z",fill:"white"}),s("path",{d:"M13.2001 19.73C12.9001 19.73 12.6101 19.58 12.4601 19.3C11.9001 18.34 10.87 17.74 9.76005 17.74C8.65005 17.74 7.62004 18.34 7.06004 19.3C6.82004 19.71 6.30005 19.85 5.89005 19.61C5.48005 19.37 5.34006 18.85 5.58006 18.44C6.44006 16.95 8.05006 16.02 9.77006 16.02C11.4901 16.02 13.1001 16.95 13.9601 18.44C14.2001 18.85 14.0601 19.38 13.6501 19.61C13.5101 19.69 13.37 19.73 13.22 19.73H13.2001Z",fill:"white"}),s("path",{d:"M9.75 12.53C6.37 12.53 3.62 9.78002 3.62 6.40002C3.62 3.02002 6.37 0.27002 9.75 0.27002C13.13 0.27002 15.88 3.02002 15.88 6.40002C15.88 9.78002 13.13 12.53 9.75 12.53ZM9.75 1.98004C7.32 1.98004 5.34003 3.96005 5.34003 6.39005C5.34003 8.82005 7.32 10.8 9.75 10.8C12.18 10.8 14.16 8.82005 14.16 6.39005C14.16 3.96005 12.18 1.98004 9.75 1.98004Z",fill:"white"})],-1)]))):_("",!0)]),_:1},8,["modelValue","error-messages","error","hint"])]),s("div",ie,[u(M,{modelValue:i.password,"onUpdate:modelValue":e[2]||(e[2]=g=>i.password=g),type:r.value?"text":"password",placeholder:"Password",variant:"outlined","append-inner-icon":r.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[3]||(e[3]=g=>r.value=!r.value),class:"auth-input","error-messages":l.password,error:l.password.length>0,"persistent-hint":"",hint:!i.password&&!l.password.length?"Enter your password (minimum 6 characters)":"",onBlur:e[4]||(e[4]=g=>L(i.password)),required:""},{"prepend-inner":d(()=>[t.$store.state.theme==="light"?(v(),C("span",ae,e[11]||(e[11]=[s("svg",{width:"15",height:"20",viewBox:"0 0 15 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M7.60999 19.6797C11.3379 19.6797 14.36 16.6576 14.36 12.9297C14.36 9.20177 11.3379 6.17969 7.60999 6.17969C3.88206 6.17969 0.859985 9.20177 0.859985 12.9297C0.859985 16.6576 3.88206 19.6797 7.60999 19.6797Z",fill:"black"}),s("path",{d:"M12.33 15.2097H2.89001V4.90973C2.89001 2.31973 4.99002 0.219727 7.58002 0.219727C10.17 0.219727 12.33 2.31973 12.33 4.90973V15.2097ZM4.38001 13.7097H10.82V4.90973C10.82 3.14973 9.39001 1.71973 7.63001 1.71973C5.87001 1.71973 4.38001 3.14973 4.38001 4.90973V13.7097Z",fill:"black"}),s("path",{d:"M7.60997 12.6096C8.37765 12.6096 8.99997 11.9873 8.99997 11.2196C8.99997 10.4519 8.37765 9.82959 7.60997 9.82959C6.84229 9.82959 6.21997 10.4519 6.21997 11.2196C6.21997 11.9873 6.84229 12.6096 7.60997 12.6096Z",fill:"white"}),s("path",{d:"M9.11997 16.0295H6.08997L6.87997 11.7896H8.32997L9.11997 16.0295Z",fill:"white"})],-1)]))):_("",!0),t.$store.state.theme==="dark"?(v(),C("span",le,e[12]||(e[12]=[s("svg",{width:"14",height:"20",viewBox:"0 0 14 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M6.75 19.6797C10.4779 19.6797 13.5 16.6576 13.5 12.9297C13.5 9.20177 10.4779 6.17969 6.75 6.17969C3.02208 6.17969 0 9.20177 0 12.9297C0 16.6576 3.02208 19.6797 6.75 19.6797Z",fill:"white"}),s("path",{d:"M11.47 15.2097H2.03003V4.90973C2.03003 2.31973 4.12997 0.219727 6.71997 0.219727C9.30997 0.219727 11.47 2.31973 11.47 4.90973V15.2097ZM3.53003 13.7097H9.96997V4.90973C9.96997 3.14973 8.54003 1.71973 6.78003 1.71973C5.02003 1.71973 3.53003 3.14973 3.53003 4.90973V13.7097Z",fill:"white"}),s("path",{d:"M6.75 12.6096C7.51768 12.6096 8.14001 11.9873 8.14001 11.2196C8.14001 10.4519 7.51768 9.82959 6.75 9.82959C5.98232 9.82959 5.35999 10.4519 5.35999 11.2196C5.35999 11.9873 5.98232 12.6096 6.75 12.6096Z",fill:"black"}),s("path",{d:"M8.27002 16.0295H5.23999L6.03003 11.7896H7.47998L8.27002 16.0295Z",fill:"black"})],-1)]))):_("",!0)]),_:1},8,["modelValue","type","append-inner-icon","error-messages","error","hint"])]),u(V,{type:"submit",block:"",class:"login-btn",loading:c.value,disabled:!y.value,size:"large"},{default:d(()=>e[13]||(e[13]=[w(" Login ")])),_:1,__:[13]},8,["loading","disabled"]),s("div",de,[u(V,{variant:"text",size:"small",class:"forgot-password-link"},{default:d(()=>e[14]||(e[14]=[w(" Forgot password? ")])),_:1,__:[14]})])]),_:1},512),s("div",ue,[s("p",ce,[e[16]||(e[16]=w(" Don't have an account? ")),u(h,{to:"/signup",class:"auth-link"},{default:d(()=>e[15]||(e[15]=[w(" Sign Up ")])),_:1,__:[15]})])])]),_:1})]),_:1})]),_:1})]),_:1}),u(E,{justify:"center",class:"header-row"},{default:d(()=>[u(S,{cols:"12",md:"10",lg:"8",class:"text-center"},{default:d(()=>e[17]||(e[17]=[s("div",{class:"auth-header"},[s("div",{class:"hero-content text-center"},[s("h1",{class:"header-title"},"it's time to be smart")])],-1)])),_:1,__:[17]})]),_:1})]),_:1}),u(U,{modelValue:p.show,"onUpdate:modelValue":e[6]||(e[6]=g=>p.show=g),color:p.color,location:"top",timeout:"4000"},{actions:d(()=>[u(V,{variant:"text",onClick:e[5]||(e[5]=g=>p.show=!1)},{default:d(()=>e[18]||(e[18]=[w(" Close ")])),_:1,__:[18]})]),default:d(()=>[w(ee(p.message)+" ",1)]),_:1},8,["modelValue","color"])])}}},pe=z(ge,[["__scopeId","data-v-9c0d5732"]]);export{pe as default};
