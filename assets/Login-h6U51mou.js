import{_ as A,r as f,Q as y,C as P,c as N,o as U,R as j,S as D,a as W,d as s,w as a,V as q,e as M,u as $,f as R,H,g as E,k as b,m as _,b as n,j as d,n as J,J as K,K as Q,L as X,x as Y,M as G,v as w,T as S,h as Z,D as ee,t as oe}from"./index-bvmpAUNA.js";import{g as h}from"./googleAuthService-C5Ngqyup.js";const se={class:"auth-page"},te={class:"form-group"},re={class:"form-group"},ae={class:"forgot-password-container"},ne={class:"auth-divider"},le={class:"google-auth-section"},ie={id:"google-signin-button-login",class:"google-signin-container"},de={class:"auth-switch"},ue={class:"switch-text"},ce={__name:"Login",setup(ge){const V=$(),x=R(),C=f(null),m=f(!1),c=f(!1),p=f(!1),t=y({email:"",password:""}),r=y({email:[],password:[]});P(()=>t.email,o=>{r.email=[],o?/.+@.+\..+/.test(o)||r.email.push("Please enter a valid email address (e.g., user@example.com)"):r.email.push("Please enter your email address")}),P(()=>t.password,o=>{r.password=[],o?o.length<6&&r.password.push("Password must be at least 6 characters long"):r.password.push("Please enter your password")});const u=y({show:!1,message:"",color:"success"}),T=N(()=>t.email&&t.password&&/.+@.+\..+/.test(t.email)&&t.password.length>=6),F=()=>{const o=k(t.email),e=L(t.password);return o&&e},k=o=>{if(r.email=[],o){if(!/.+@.+\..+/.test(o))return r.email.push("Please enter a valid email address (e.g., user@example.com)"),!1}else return r.email.push("Please enter your email address"),!1;return!0},L=o=>{if(r.password=[],o){if(o.length<6)return r.password.push("Password must be at least 6 characters long"),!1}else return r.password.push("Please enter your password"),!1;return!0},I=async()=>{if(F()){c.value=!0;try{await V.dispatch("login",{email:t.email,password:t.password}),g("Login successful! Welcome back.","success"),setTimeout(()=>{x.push({name:"Profile"})},1500)}catch{g("Login failed. Please check your credentials.","error")}finally{c.value=!1}}},g=(o,e)=>{u.message=o,u.color=e,u.show=!0},v=async o=>{c.value=!0;try{const{userInfo:e}=o.detail,i=h.convertToAppUser(e);await V.dispatch("googleSignup",i),g("Login successful with Google! Welcome back.","success"),setTimeout(()=>{x.push({name:"Profile"})},1500)}catch(e){console.error("Google login error:",e),g("Google login failed. Please try again.","error")}finally{c.value=!1}},B=o=>{console.error("Google auth error:",o.detail),g("Google authentication failed. Please try again.","error")},O=async()=>{try{c.value=!0;const o=await h.signInWithPopup();await v({detail:o})}catch(o){console.error("Google popup login error:",o),g("Google login was cancelled or failed.","error"),c.value=!1}},z=()=>{const o=document.getElementById("google-signin-button-login");if(!o)return null;const e=new MutationObserver(i=>{const l=o.querySelector('iframe, div[role="button"]');l&&(l.style.margin="0 auto",p.value=!0)});return e.observe(o,{childList:!0,subtree:!0}),window.googleLoginButtonObserver=e,e};return U(async()=>{try{await h.init(),window.addEventListener("googleAuthSuccess",v),window.addEventListener("googleAuthError",B);const o=z();await j();const e=document.getElementById("google-signin-button-login");if(e)try{await h.renderSignInButton("google-signin-button-login",{type:"standard",theme:"outline",size:"large",text:"signin_with",shape:"rectangular",width:270,logo_alignment:"center"});const i=e.querySelector('iframe, div[role="button"]');i&&(i.style.margin="0 auto",p.value=!0)}catch(i){console.error("Error rendering Google button:",i),p.value=!1}}catch(o){console.error("Failed to initialize Google Auth:",o)}}),D(()=>{window.removeEventListener("googleAuthSuccess",v),window.removeEventListener("googleAuthError",B),window.googleLoginButtonObserver&&(window.googleLoginButtonObserver.disconnect(),window.googleLoginButtonObserver=null)}),(o,e)=>{const i=H("router-link");return E(),W("div",se,[s(q,{class:"auth-container"},{default:a(()=>[s(b,{justify:"center",class:"header-row"},{default:a(()=>[s(_,{cols:"12",md:"10",lg:"8",class:"text-center"},{default:a(()=>e[7]||(e[7]=[n("div",{class:"auth-header"},[n("div",{class:"hero-content text-center"},[n("h1",{class:"header-title"},[d(" it's easy to customize your profile."),n("br"),d(" join itag to be smart "),n("span",{class:"highlight"},"NOW!")])])],-1)])),_:1,__:[7]})]),_:1}),s(b,{justify:"center",align:"center",class:"form-row"},{default:a(()=>[s(_,{cols:"12",sm:"8",md:"6",lg:"4",xl:"3"},{default:a(()=>[s(J,{class:"auth-card",elevation:"0"},{default:a(()=>[s(K,{class:"text-center"},{default:a(()=>e[8]||(e[8]=[n("h2",{style:{"font-size":"36px","font-weight":"200"}},"Login",-1)])),_:1,__:[8]}),s(Q,{class:"auth-content"},{default:a(()=>[s(X,{onSubmit:Y(I,["prevent"]),ref_key:"loginForm",ref:C},{default:a(()=>[n("div",te,[s(G,{modelValue:t.email,"onUpdate:modelValue":e[0]||(e[0]=l=>t.email=l),type:"email",placeholder:"E-mail",variant:"outlined","prepend-inner-icon":"mdi-account-outline",class:"auth-input","error-messages":r.email,error:r.email.length>0,"persistent-hint":"",hint:!t.email&&!r.email.length?"Enter your email address":"",onBlur:e[1]||(e[1]=l=>k(t.email)),required:""},null,8,["modelValue","error-messages","error","hint"])]),n("div",re,[s(G,{modelValue:t.password,"onUpdate:modelValue":e[2]||(e[2]=l=>t.password=l),type:m.value?"text":"password",placeholder:"Password",variant:"outlined","prepend-inner-icon":"mdi-lock-outline","append-inner-icon":m.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[3]||(e[3]=l=>m.value=!m.value),class:"auth-input","error-messages":r.password,error:r.password.length>0,"persistent-hint":"",hint:!t.password&&!r.password.length?"Enter your password (minimum 6 characters)":"",onBlur:e[4]||(e[4]=l=>L(t.password)),required:""},null,8,["modelValue","type","append-inner-icon","error-messages","error","hint"])]),s(w,{type:"submit",block:"",class:"login-btn",loading:c.value,disabled:!T.value,size:"large"},{default:a(()=>e[9]||(e[9]=[d(" LOGIN ")])),_:1,__:[9]},8,["loading","disabled"]),n("div",ae,[s(w,{variant:"text",size:"small",class:"forgot-password-link"},{default:a(()=>e[10]||(e[10]=[d(" Forgot password? ")])),_:1,__:[10]})])]),_:1},512),n("div",ne,[s(S,{class:"divider-line"}),e[11]||(e[11]=n("span",{class:"divider-text"},"or",-1)),s(S,{class:"divider-line"})]),n("div",le,[n("div",ie,[p.value?ee("",!0):(E(),Z(w,{key:0,onClick:O,block:"",variant:"outlined",class:"google-signin-btn",size:"large","prepend-icon":"mdi-google"},{default:a(()=>e[12]||(e[12]=[d(" Sign in with Google ")])),_:1,__:[12]}))])]),n("div",de,[n("p",ue,[e[14]||(e[14]=d(" Don't have an account? ")),s(i,{to:"/signup",class:"auth-link"},{default:a(()=>e[13]||(e[13]=[d(" Sign up here ")])),_:1,__:[13]})])])]),_:1})]),_:1})]),_:1})]),_:1}),s(b,{justify:"center",class:"header-row"},{default:a(()=>[s(_,{cols:"12",md:"10",lg:"8",class:"text-center"},{default:a(()=>e[15]||(e[15]=[n("div",{class:"auth-header"},[n("div",{class:"hero-content text-center"},[n("h1",{class:"header-title"}," it's time to be smart ")])],-1)])),_:1,__:[15]})]),_:1})]),_:1}),s(M,{modelValue:u.show,"onUpdate:modelValue":e[6]||(e[6]=l=>u.show=l),color:u.color,location:"top",timeout:"4000"},{actions:a(()=>[s(w,{variant:"text",onClick:e[5]||(e[5]=l=>u.show=!1)},{default:a(()=>e[16]||(e[16]=[d(" Close ")])),_:1,__:[16]})]),default:a(()=>[d(oe(u.message)+" ",1)]),_:1},8,["modelValue","color"])])}}},fe=A(ce,[["__scopeId","data-v-9ac2c60f"]]);export{fe as default};
